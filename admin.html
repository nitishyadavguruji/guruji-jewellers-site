<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Guru Ji Jewellers – Admin Panel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #4c1d95, #020617 55%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
      color: #111827;
    }
    .card {
      width: 100%;
      max-width: 680px;
      background: #f9fafb;
      border-radius: 20px;
      padding: 20px 18px 22px;
      box-shadow: 0 22px 45px rgba(15, 23, 42, 0.55);
      border: 1px solid rgba(148, 163, 184, 0.35);
    }
    .card-header { margin-bottom: 10px; }
    .title {
      font-size: 20px;
      font-weight: 700;
      color: #111827;
    }
    .subtitle {
      font-size: 13px;
      color: #4b5563;
      margin-top: 4px;
    }
    .badge {
      display: inline-flex;
      align-items: center;
      font-size: 11px;
      padding: 3px 8px;
      border-radius: 999px;
      background: #eef2ff;
      color: #4338ca;
      margin-top: 6px;
      gap: 4px;
    }
    .badge-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: #22c55e;
    }

    form {
      margin-top: 10px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px 14px;
    }
    label {
      font-size: 12px;
      font-weight: 600;
      color: #374151;
      display: block;
      margin-bottom: 3px;
    }
    input,
    select,
    textarea {
      width: 100%;
      padding: 7px 8px;
      border-radius: 8px;
      border: 1px solid #d1d5db;
      font-size: 13px;
      background: #ffffff;
      transition: border 0.15s, box-shadow 0.15s;
    }
    input:focus,
    select:focus,
    textarea:focus {
      outline: none;
      border-color: #f59e0b;
      box-shadow: 0 0 0 1px rgba(245, 158, 11, 0.5);
    }
    textarea {
      resize: vertical;
      min-height: 60px;
    }
    .full-row { grid-column: 1 / 3; }

    .hint {
      font-size: 11px;
      color: #6b7280;
      margin-top: 2px;
    }

    .actions {
      grid-column: 1 / 3;
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: 6px;
    }
    .btn-primary {
      border: none;
      border-radius: 999px;
      padding: 8px 18px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      background: linear-gradient(135deg, #fbbf24, #f97316);
      color: #111827;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      box-shadow: 0 10px 20px rgba(249, 115, 22, 0.4);
    }
    .btn-primary:disabled {
      opacity: 0.6;
      cursor: wait;
      box-shadow: none;
    }
    #status {
      font-size: 12px;
      max-width: 260px;
      text-align: right;
    }
    #status.success { color: #16a34a; }
    #status.error { color: #b91c1c; }

    .recent {
      grid-column: 1 / 3;
      margin-top: 8px;
      padding: 8px 10px;
      border-radius: 10px;
      background: #111827;
      color: #e5e7eb;
      font-size: 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .recent span { display: block; }

    @media (max-width: 640px) {
      .card { padding: 18px 14px 20px; }
      form { grid-template-columns: 1fr; }
      .full-row { grid-column: 1 / 2; }
      .actions {
        flex-direction: column;
        align-items: flex-start;
        gap: 6px;
      }
      #status { text-align: left; }
      .recent {
        flex-direction: column;
        align-items: flex-start;
        gap: 4px;
      }
    }
  </style>
</head>
<body>
  <div class="card">
    <div class="card-header">
      <div class="title">Guru Ji Jewellers – Product Upload</div>
      <div class="subtitle">
        Yahaan se new products add karo – bracelet, pendant, payal etc. Photo ke saath.
      </div>
      <div class="badge">
        <span class="badge-dot"></span> Admin Use Only
      </div>
    </div>

    <form id="productForm">
      <div class="full-row">
        <label>Product Name</label>
        <input type="text" name="name" required placeholder="e.g. Gents Heavy Gold Bracelet" />
      </div>

      <div>
        <label>Category</label>
        <select name="category" required>
          <option value="">Select category</option>
          <option>Gents Bracelet</option>
          <option>Ladies Bracelet</option>
          <option>Gents Pendant</option>
          <option>Ladies Pendant</option>
          <option>God Pendant</option>
          <option>Kids Jewellery</option>
          <option>Payal / Anklet</option>
          <option>Earrings</option>
          <option>Rings</option>
          <option>Customised Name Pendant</option>
          <option>Other Jewellery</option>
        </select>
      </div>

      <div>
        <label>Price (₹)</label>
        <input type="number" name="price" required placeholder="e.g. 25999" />
        <div class="hint">Approx showcase price – final billing weight pe hoga.</div>
      </div>

      <div>
        <label>Rating (1–5)</label>
        <input type="number" name="rating" min="1" max="5" step="0.1" placeholder="4.8" />
        <div class="hint">Optional – default 4.8 maan lenge.</div>
      </div>

      <div>
        <label>Photo (image)</label>
        <input type="file" name="image" accept="image/*" />
        <div class="hint">Clear front photo – bracelet / pendant centred ho.</div>
      </div>

      <div class="full-row">
        <label>Short Description</label>
        <input
          type="text"
          name="shortDescription"
          placeholder="Premium 22K design – Daily wear, durable finish."
        />
      </div>

      <div class="full-row">
        <label>Full Description / Details</label>
        <textarea
          name="description"
          placeholder="Weight range, alloy, purity, ideal for which occasion etc."
        ></textarea>
      </div>

      <div class="actions">
        <button type="submit" class="btn-primary" id="submitBtn">
          ➕ Add New Product
        </button>
        <div id="status"></div>
      </div>

      <div class="recent" id="recentBox" style="display: none;">
        <span>Last upload:</span>
        <span id="recentText"></span>
      </div>
    </form>
  </div>

  <script>
    const API_URL = "https://guruji-api.onrender.com/api/products"; // backend
    const SHEET_WEBAPP_URL = "https://script.google.com/macros/s/AKfycbxNBBVsI0OVCa4jyJNuoZrLRo8PmSaeDsRPpWM3C0s6Jg9tz6_jbH2Ab4llJC3awlSk/exec"; // <-- yahan apna /exec URL daalo

    const form = document.getElementById("productForm");
    const statusEl = document.getElementById("status");
    const submitBtn = document.getElementById("submitBtn");
    const recentBox = document.getElementById("recentBox");
    const recentText = document.getElementById("recentText");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      statusEl.textContent = "Uploading photo & saving product...";
      statusEl.className = "";
      submitBtn.disabled = true;

      const formData = new FormData(form);

      try {
        // 1) Backend pe POST – image upload + image URL banega
        const res = await fetch(API_URL, {
          method: "POST",
          body: formData,
        });

        const data = await res.json();

        if (!res.ok || !data.success) {
          statusEl.textContent = data.message || "Upload failed, please try again.";
          statusEl.className = "error";
          submitBtn.disabled = false;
          return;
        }

        const product = data.product;

        // 2) Ab Google Sheet (Apps Script) ko call – data save karne ke liye
        try {
          const sheetRes = await fetch(SHEET_WEBAPP_URL, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(product),
          });

          const sheetData = await sheetRes.json();

          if (!sheetRes.ok || !sheetData.success) {
            console.log("Sheet write error:", sheetData);
            statusEl.textContent =
              "Photo upload ho gayi, par sheet me save nahi hua. Thodi der baad try karo.";
            statusEl.className = "error";
          } else {
            statusEl.textContent = "✅ Upload successful – product saved.";
            statusEl.className = "success";
            recentText.textContent = `${product.name} – ₹${product.price}`;
            recentBox.style.display = "flex";
            form.reset();
          }
        } catch (sheetErr) {
          console.error("Sheet error:", sheetErr);
          statusEl.textContent =
            "Photo upload ho gayi, par sheet se connection fail. Thodi der baad try karo.";
          statusEl.className = "error";
        }
      } catch (err) {
        console.error(err);
        statusEl.textContent = "Server se connect nahi ho pa raha. Thodi der baad try karo.";
        statusEl.className = "error";
      } finally {
        submitBtn.disabled = false;
      }
    });
  </script>
</body>
</html>
